<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html>

<head>
<style type="text/css">
A.black:link {COLOR: #000000; TEXT-DECORATION: none;FONT-FAMILY: Arial,Verdana,Tahoma,sans-serif; FONT-SIZE: 9pt}
A.black:visited {COLOR: #000000; TEXT-DECORATION: none;FONT-FAMILY: Arial,Verdana,Tahoma,sans-serif; FONT-SIZE: 9pt}
A.black:hover {COLOR: #FFFFFF; TEXT-DECORATION: none;FONT-FAMILY: Arial,Verdana,Tahoma,sans-serif; FONT-SIZE: 9pt}
.b {text-decoration: none; color:#FF0000;} 
.b:hover {color:#7785FF;}
.c {text-decoration: none; color:#000000;} 
.c:hover {color:#FFFFFF;}
 pre {color: blue;}
TD.colon {COLOR: #000000; FONT-FAMILY: "MS Sans Serif", sans-serif; FONT-SIZE: 9pt}
</style>
<meta http-equiv="Content-Type" content="text/html; charset=windows-1251">
<meta content="программирование на Visual Basic, документация, документы, delphi, pascal, cpp, hardware, web, веб-мастер, советы, описания, доки, manual, Java, C, C++, обучение, исходники, odbc, jdbc, programm, protocols, протоколы, общение, форумapplet, java, design, апплет, дизайн, ява, Free, counters, Trackers, Guestbooks, Access Logs, Banners, Graphics, Banner ads, Fonts, Form Mailer, form mailers, graphics, icons, games, freeware, shareware, forms, guestbooks, Java, Javascript, contests, puzzles, fonts, font resources, E-mail programs, reminder services, product samples, samples, Email services, E-mail services, advertising, graphics, free banner ads, free World Wide Web resources, counters, Trackers, Guestbooks, Access Logs, Banners, Graphics, Banner ads, Fonts, Form Mailer, form mailers, graphics, icons, games, freeware, shareware, forms, guestbooks, Java, Javascript, contests, puzzles, fonts, font resources, E-mail programs, reminder services, product samples, samples, Email services, E-mail services, advertising, graphics, free banner ads, free World Wide Web resources" name="keywords">
<meta NAME="RESOURCE-TYPE"
CONTENT="pop hypertext sources hypermedia server scripting shtml phtml html developer code base tools open source web site browser free software webmaster cgi dhtml dynamic content netscape explorer shareware download website construction free tutorial news design maintenance page hit cvs mailing list projects httpd mod_perl mod www htdig xml perl scripts script server-side-include apache database MySQL mysql msql postres postresql module linux online cpp Visual Basic JavaScript delphi wap job informer java opengl directx">
<title>Информационный сервер для программистов - исходники со всего света.</title>
</head>

<body topmargin="0" leftmargin="0" marginwidth="0" marginheigth="0" bgcolor=white>

<form action="/cgi-bin/sources/search/search.pl" method="get" align="left">
  <input type="hidden" name="stpos" value="0"><table border="0" cellpadding="0"
  cellspacing="0" width="750">
    <tr>
      <td valign="top" rowspan="2"><table border="0" cellpadding="0" cellspacing="0" width="287">
        <tr>
          <td colspan="2" bgcolor="#A5E4A7" valign="middle" align="center"><b>WWW.ИСХОДНИКИ.РУ</b></td>
          <td bgcolor="#000080" valign="middle" align="center"><b><font face="Tahoma"
          style="font-size: 8pt" size="-1" color="#FFFFFF">cpp.sources.ru</font></b></td>
        </tr>
        <tr>
          <td bgcolor="#000080" valign="middle" align="center"><b><font face="Tahoma"
          style="font-size: 8pt" size="-1" color="#FFFFFF">java.sources.ru</font></b></td>
          <td bgcolor="#C0C0C0" valign="middle" align="center"><font face="Tahoma"
          style="font-size: 8pt" size="-1"><b>web.sources.ru</b></font></td>
          <td bgcolor="#A5E4A7" valign="middle" align="center"><font face="Tahoma"
          style="font-size: 8pt" size="-1"><b>soft.sources.ru</b></font></td>
        </tr>
        <tr>
          <td bgcolor="#C0C0C0" valign="middle" align="center"><font face="Tahoma"
          style="font-size: 8pt" size="-1"><b>jdbc.sources.ru</b></font></td>
          <td bgcolor="#A5E4A7" valign="middle" align="center"><font face="Tahoma"
          style="font-size: 8pt" size="-1"><b>asp.sources.ru</b></font></td>
          <td bgcolor="#000080" valign="middle" align="center"><b><font face="Tahoma"
          style="font-size: 8pt" size="-1" color="#FFFFFF">api.sources.ru</font></b></td>
        </tr>
      </table>
      <table border="0" cellpadding="0" cellspacing="0" width="100%">
        <tr>
          <td><font style="font-size: 8pt" size="2" face="Tahoma">&nbsp; Поиск по
          программированию :<br>
          </font>&nbsp; <input type="text" size="13" name="query"> <input type="submit"
          value="Поиск"><font size="1"><input
          TYPE="Radio" NAME="stype" VALUE="AND" checked>&quot;AND&quot; <input TYPE="Radio"
          NAME="stype" VALUE="OR">&quot;OR&quot;</font>


<!--TopList COUNTER--><a target=_top
href="http://top.list.ru/jump?from=89876"><script language="JavaScript"><!--
d=document;a='';a+=';r='+escape(d.referrer)
js=10//--></script><script language="JavaScript1.1"><!--
a+=';j='+navigator.javaEnabled()
js=11//--></script><script language="JavaScript1.2"><!--
s=screen;a+=';s='+s.width+'*'+s.height
a+=';d='+(s.colorDepth?s.colorDepth:s.pixelDepth)
js=12//--></script><script language="JavaScript1.3"><!--
js=13//--></script><script language="JavaScript"><!--
d.write('<img src="http://top.list.ru/counter'+
'?id=89876;t=57;js='+js+a+';rand='+Math.random()+
'" alt="TopList" '+ 'border=0 height=1 width=1>')
if(js>11)d.write('<'+'!-- ')//--></script><noscript><img
src="http://top.list.ru/counter?js=na;id=89876;t=57"
border=0 height=1 width=1
alt="TopList"></noscript><script language="JavaScript"><!--
if(js>11)d.write('--'+'>')//--></script></a><!--TopList COUNTER-->


<a href="http://counter.rambler.ru/top100/"><img src="http://counter.rambler.ru/top100.cnt?163871" alt="Rambler's Top100" width=1 height=1 border=0></a>

<!-- SpyLOG f:0211 --> 
<script language="javascript"> 
u="u1624.10.spylog.com";d=document;nv=navigator;na=nv.appName;p=1; 
bv=Math.round(parseFloat(nv.appVersion)*100); 
n=(na.substring(0,2)=="Mi")?0:1;rn=Math.random();z="p="+p+"&rn="+rn;y=""; 
y+="<a href='http://"+u+"/cnt?f=3&p="+p+"&rn="+rn+"' target=_blank>"; 
y+="<img src='http://"+u+"/cnt?"+z+ "&r="+escape(d.referrer)+"&pg="+escape(window.location.href)+"' border=0 width=1 height=1 alt='SpyLOG'>"; 
y+="</a>"; d.write(y);if(!n) { d.write("<"+"!--"); }//--></script><noscript> 
<a href="http://u1624.10.spylog.com/cnt?f=3&p=1" target=_blank> 
<img src="http://u1624.10.spylog.com/cnt?p=1" alt='SpyLOG' border='0' width=1 height=1 > 
</a></noscript><script language="javascript1.2"><!-- 
if(!n) { d.write("--"+">"); }//--></script> 
<!-- SpyLOG -->


</td>
        </tr>
      </table>
      </td>
      <td align="center"><font style="font-size: 15pt" color="#4904B1" size="4"
      face="Times New Roman">Информационный сервер</font></td>
    </tr>
    <tr>
      <td>


<!-- LBE -->
<script>
// <!--
rand = Math.round((Math.random() * (10000 - 1)));
document.write("<a href=http://www.lbe.ru/cgi-bin/href/castle?" + rand + " target=_blank><img src=http://www.lbe.ru/cgi-bin/banner/castle?" + rand + " width=468 height=60 border=0 alt=LBE ismap></a><br>");
// -->
</script>
<noscript>
                                                                                                                                                                <br>
</noscript>
<!-- LBE -->



      </td>
    </tr>
    <tr>
      <td colspan="2"><table border="0" cellpadding="0" cellspacing="1" width="100%">
        <tr>
          <td align="center" width="11%" bgcolor="#E0E0C6"><a
          href="../www.sources.html"><font color="#000000" size="2">На главную</font></a></td>
          <td align="center" width="20%" bgcolor="#E0E0C6"><a
          href="../subscribe.html"><font color="#000000" size="2">Подписаться на новости</font></a></td>
          <td align="center" width="11%" bgcolor="#E0E0C6"><a href="../cgi-bin/sources/Ultimate.pl"><font color="#000000" size="2">Форум</font></a></td>
          <td align="center" width="11%" bgcolor="#E0E0C6"><a href="../books.html"><font color="#000000" size="2">Книги</font></a></td>
          <td align="center" width="7%" bgcolor="#E0E0C6"><a href="http://chat.vidcenter.ru:82/"><font color="#000000" size="2">Чат</font></a></td>
          <td align="center" width="13%" bgcolor="#E0E0C6"><a href="http://www.countries.ru/"><font color="#000000" size="2">Страны мира</font></a></td>
          <td align="center" width="29%" bgcolor="#E0E0C6"><b>5</b> пользователей на сервере.
</td>
        </tr>
      </table>
      </td>
    </tr>
  </table>
</form>

<div align="center"><center>

<table width="680" cellspacing="0" cellpadding="0">
  <tr>
    <td><hr>
    <h3>Простые ODBC классы без использования MFC</h3>
    <p>Автор: <a href="mailto:justink@rochester.rr.com">Justin Kirby</a></p>
    <a href="simple_odbc_src.zip"><p>Скачать исходники - 7 Kb</a> </p>
    <font color="#000000" face="Verdana" size="2"><font color="#ff9900" face="Verdana"
    size="3"><b><p>Описание</b></font> </p>
    <p>Мне пришлось написать довольно много
    приложений связанных с базами данных.
    Большинство из них было небольшими и
    использовали MFC класс </font><font face="Verdana" size="2"
    color="#FF0000">CRecordset</font><font color="#000000" face="Verdana" size="2">.
    Зависимость от MFC меня не всегда устраивала и
    тогда я засел за создание собственного класса.
    Таким образом появился набор, состоящий из
    нескольких классов, обеспечивающий необходимые
    возможности для работы с ODBC драйвером. </p>
    <p>На самом деле эти классы не претендуют на что-то
    &quot;совершенное&quot; и &quot;мощное&quot;, однако они
    могут очень даже пригодиться для тех кто захочет
    работать с драйвером ODBC напрямую через API
    функции. </p>
    <p>В файлах ODBC.h и ODBC.cpp содержится три класса <font
    face="Verdana" size="2" color="#FF0000">CODBCCnx</font>, <font face="Verdana" size="2"
    color="#FF0000">CODBCQuery</font> и <font face="Verdana" size="2" color="#FF0000">CODBCFatQuery</font>.
    Основным из них является <font face="Verdana" size="2"
    color="#FF0000">CODBCCnx</font>, который коннектится к DBMS, а так
    же осуществляет все необходимые действия по
    обработке запросов. <font face="Verdana" size="2" color="#FF0000">CODBCQuery</font>
    и <font face="Verdana" size="2" color="#FF0000">CODBCFatQuery</font> являются
    зарезервированными, и я планирую с их помощью
    расширить возможности основного класса. </p>
    <font color="#ff9900" face="Verdana" size="3"><b><p>Класс CODBCCnx</b></font> </p>
    <p></font><font face="Verdana" size="2" color="#FF0000">CODBCCnx</font><font
    color="#000000" face="Verdana" size="2"> содержит три функции </font><font
    face="Verdana" size="2" color="#FF0000">Connect()</font><font color="#000000"
    face="Verdana" size="2">, </font><font face="Verdana" size="2" color="#FF0000">Disconnect()</font><font
    color="#000000" face="Verdana" size="2"> и </font><font face="Verdana" size="2"
    color="#FF0000">IsOk()</font><font color="#000000" face="Verdana" size="2">.
    Функция </font><font face="Verdana" size="2" color="#FF0000">Connect()</font><font
    color="#000000" face="Verdana" size="2"> позволяет связаться с
    драйвером DSN или используя сетевое имя
    компьютера. </p></font>
    <pre>//связываемся с DBMS через DSN, &quot;foodsn&quot;

CODBCCnx dsn();
dsn.Connect(&quot;foodsn&quot;,&quot;username&quot;,&quot;password&quot;);

//Замечание: CODBCCnx dsn(&quot;foodsn&quot;,username&quot;,&quot;password&quot;); идентично предыдущей строке

//проверяем успешность соединения
if(!dsn.IsOk()){
	//успешное соединение с базой
}
else{
	//ошибка при соединении
}

//другой способ осуществления связи с базой данны, используя сетевое имя компьютера
CODBCCnx name(&quot;SQL Server&quot;,&quot;CompName&quot;,&quot;username&quot;,&quot;password&quot;);
//опять проверяем успешность соединения
if(!name.IsOk()){
	//успешное соединение с базой
}
else{
	//ошибка при соединении
}</pre><font color="#000000" face="Verdana" size="2">
    <p>Итак, мы соединились с базой данных, теперь
    давайте попробуем завершить сеанс связи. Для
    этого нам пригодится функция </font><font face="Verdana" size="2"
    color="#FF0000">Disconnect()</font><font color="#000000" face="Verdana" size="2">. В
    параметрах этой функции можно задавать
    различные параметры. Например, если транзакции
    находятся в активном состоянии, то с помощь этих
    параметров можно вернуть их в исходное
    состояние, либо подождать их завершения. Если
    вызвать функцию <font face="Verdana" size="2" color="#FF0000">Disconnect</font>,
    без параметров, то все транзакции вернутся в
    исходное состояние. </p></font>
    <pre>//завершаем сеанс связи (dsn)
dsn.Disconnect();	//возвращаем незавершённые транзакции в предыдущее состояние
//Замечание: dsn.Disconnect(SQL_ROLLBACK) тоже самое, что и предыдущая строка


//завершаем сеанс связи с базой &quot;name&quot;
name.Disconnect(SQL_COMMIT); //завершаем все незавершённые транзакции</pre>
    <font color="#ff9900" face="Verdana" size="3"><b><p>Класс CODBCQuery</b></font> </p><font color="#000000" face="Verdana" size="2">
    <p>Итак, мы рассмотрели основные действия для
    общения с базой данных. Но есть ещё один момент.
    Не полохо было бы работать с объектом, созданным
    ранее, через указатели, то есть сделать его
    доступным из других классов. Для этого был создан
    класс </font><font face="Verdana" size="2" color="#FF0000">CODBCQuery</font><font
    color="#000000" face="Verdana" size="2">. </font><font face="Verdana" size="2"
    color="#FF0000">CODBCQuery</font><font color="#000000" face="Verdana" size="2"> не
    может использоваться как самостоятельный
    объект, он постоянно привязан к основному классу:
    </p></font>
    <pre>//Устанавливаем соединение, используя dsn
CODBCCnx *pDsn = new CODBCCnx(&quot;foodsn&quot;, &quot;username&quot;, &quot;password&quot;);
CODBCQuery qry1, qry2;

if(!pDsn-&gt;IsOk())
{
	//успешный коннект!! теперь дадим в доступ данный сеанс связи :)
	pDsn-&gt;Connect(qry1.h_qstmt);
	pDsn-&gt;Connect(qry2.h_qstmt);
}
else{
	//ошибка
}

//так же эту процедуру можно совешнить за один шаг.
CODBCQuery qry(new CODBCCnx(&quot;foodsn&quot;, &quot;username&quot;, &quot;password&quot;), true);

//либо мы можем брать pDsn и передавать его в связку новых объектов
CODBCQuery qry2(pDsn), qry3(pDsn,false);

//либо можно заставить класс CODBCQuery самостоятельно коннектиться
CODBCQuery qry4(&quot;SQL Server&quot;, &quot;CompName&quot;, &quot;username&quot;, &quot;password&quot;);
//используя DSN
CODBCQuery qry5(NULL, &quot;foodsn&quot;, &quot;username&quot;, &quot;password&quot;);</pre><font color="#000000" face="Verdana" size="2">
    <p>Заключительная заметка: существует глобальная
    функция </font><font face="Verdana" size="2" color="#FF0000">SQLSuccess()</font><font
    color="#000000" face="Verdana" size="2">. Если передать в неё
    переменную </font><font face="Verdana" size="2" color="#FF0000">SQLRETURN</font><font
    color="#000000" face="Verdana" size="2">, то функция вернёт не
    нулевое значение, если в этой переменной указать
    значение </font><font face="Verdana" size="2" color="#FF0000">SQL_SUCCESS</font><font
    color="#000000" face="Verdana" size="2"> или </font><font face="Verdana" size="2"
    color="#FF0000">SQL_SUCCESS_WITH_INFO</font><font color="#000000" face="Verdana" size="2">.
    Иногда возвращаемая информация бывает очень
    даже полезной.</p>
    <font color="#ff9900" face="Verdana" size="3"><b><p>В дополнение</b></font> </p>
    <p>В архиве содержатся два файла strutil.h и strutil.cpp. Это
    очень простые функции имеющие тип </font><font face="Verdana"
    size="2" color="#FF0000">char*</font><font color="#000000" face="Verdana" size="2">.
    Меня раздражает постоянная необходимость по
    выделению памяти для </font><font face="Verdana" size="2"
    color="#FF0000">strcpy</font><font color="#000000" face="Verdana" size="2">, и т.д...
    Поэтому мне больше подходят эти две функции
    взамен стандартных. Их названия начинаются с
    jkl_str. Надеюсь, они Вам понравятся :).</p>
    <p><br>
    </font></td>
  </tr>
</table>
</center></div></TBODY>


<p align="center"><br>
<br></p>


<hr>
<div align="center"><center>

<table border="0" cellpadding="0" cellspacing="3" width="468">
  <tr>
    <td width="154"><!-- LBE_LITE --> <script>
// <!--
rand = Math.round((Math.random() * (10000 - 1)));
document.write("<a href=http://lite.lbe.ru/cgi-bin/href/castle?" + rand + " target=_blank><img src=http://lite.lbe.ru/cgi-bin/banner/castle?" + rand + " width=468 height=60 border=0 alt=LBE_LITE ismap></a><br>");
// -->
</script> <noscript> <br>
</noscript><!-- LBE_LITE --></td>
  </tr>
</table>
</center></div>
</body>
</html>
