<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html>

<head>
<style type="text/css">
A.black:link {COLOR: #000000; TEXT-DECORATION: none;FONT-FAMILY: Arial,Verdana,Tahoma,sans-serif; FONT-SIZE: 9pt}
A.black:visited {COLOR: #000000; TEXT-DECORATION: none;FONT-FAMILY: Arial,Verdana,Tahoma,sans-serif; FONT-SIZE: 9pt}
A.black:hover {COLOR: #FFFFFF; TEXT-DECORATION: none;FONT-FAMILY: Arial,Verdana,Tahoma,sans-serif; FONT-SIZE: 9pt}
.b {text-decoration: none; color:#FF0000;} 
.b:hover {color:#7785FF;}
.c {text-decoration: none; color:#000000;} 
.c:hover {color:#FFFFFF;}
 pre {color: blue;}
TD.colon {COLOR: #000000; FONT-FAMILY: "MS Sans Serif", sans-serif; FONT-SIZE: 9pt}
</style>
<meta http-equiv="Content-Type" content="text/html; charset=windows-1251">
<meta content="программирование на Visual Basic, документация, документы, delphi, pascal, cpp, hardware, web, веб-мастер, советы, описания, доки, manual, Java, C, C++, обучение, исходники, odbc, jdbc, programm, protocols, протоколы, общение, форумapplet, java, design, апплет, дизайн, ява, Free, counters, Trackers, Guestbooks, Access Logs, Banners, Graphics, Banner ads, Fonts, Form Mailer, form mailers, graphics, icons, games, freeware, shareware, forms, guestbooks, Java, Javascript, contests, puzzles, fonts, font resources, E-mail programs, reminder services, product samples, samples, Email services, E-mail services, advertising, graphics, free banner ads, free World Wide Web resources, counters, Trackers, Guestbooks, Access Logs, Banners, Graphics, Banner ads, Fonts, Form Mailer, form mailers, graphics, icons, games, freeware, shareware, forms, guestbooks, Java, Javascript, contests, puzzles, fonts, font resources, E-mail programs, reminder services, product samples, samples, Email services, E-mail services, advertising, graphics, free banner ads, free World Wide Web resources" name="keywords">
<meta NAME="RESOURCE-TYPE"
CONTENT="pop hypertext sources hypermedia server scripting shtml phtml html developer code base tools open source web site browser free software webmaster cgi dhtml dynamic content netscape explorer shareware download website construction free tutorial news design maintenance page hit cvs mailing list projects httpd mod_perl mod www htdig xml perl scripts script server-side-include apache database MySQL mysql msql postres postresql module linux online cpp Visual Basic JavaScript delphi wap job informer java opengl directx">
<title>Информационный сервер для программистов - исходники со всего света.</title>
</head>

<body topmargin="0" leftmargin="0" marginwidth="0" marginheigth="0" bgcolor=white>

<form action="/cgi-bin/sources/search/search.pl" method="get" align="left">
  <input type="hidden" name="stpos" value="0"><table border="0" cellpadding="0"
  cellspacing="0" width="750">
    <tr>
      <td valign="top" rowspan="2"><table border="0" cellpadding="0" cellspacing="0" width="287">
        <tr>
          <td colspan="2" bgcolor="#A5E4A7" valign="middle" align="center"><b>WWW.ИСХОДНИКИ.РУ</b></td>
          <td bgcolor="#000080" valign="middle" align="center"><b><font face="Tahoma"
          style="font-size: 8pt" size="-1" color="#FFFFFF">cpp.sources.ru</font></b></td>
        </tr>
        <tr>
          <td bgcolor="#000080" valign="middle" align="center"><b><font face="Tahoma"
          style="font-size: 8pt" size="-1" color="#FFFFFF">java.sources.ru</font></b></td>
          <td bgcolor="#C0C0C0" valign="middle" align="center"><font face="Tahoma"
          style="font-size: 8pt" size="-1"><b>web.sources.ru</b></font></td>
          <td bgcolor="#A5E4A7" valign="middle" align="center"><font face="Tahoma"
          style="font-size: 8pt" size="-1"><b>soft.sources.ru</b></font></td>
        </tr>
        <tr>
          <td bgcolor="#C0C0C0" valign="middle" align="center"><font face="Tahoma"
          style="font-size: 8pt" size="-1"><b>jdbc.sources.ru</b></font></td>
          <td bgcolor="#A5E4A7" valign="middle" align="center"><font face="Tahoma"
          style="font-size: 8pt" size="-1"><b>asp.sources.ru</b></font></td>
          <td bgcolor="#000080" valign="middle" align="center"><b><font face="Tahoma"
          style="font-size: 8pt" size="-1" color="#FFFFFF">api.sources.ru</font></b></td>
        </tr>
      </table>
      <table border="0" cellpadding="0" cellspacing="0" width="100%">
        <tr>
          <td><font style="font-size: 8pt" size="2" face="Tahoma">&nbsp; Поиск по
          программированию :<br>
          </font>&nbsp; <input type="text" size="13" name="query"> <input type="submit"
          value="Поиск"><font size="1"><input
          TYPE="Radio" NAME="stype" VALUE="AND" checked>&quot;AND&quot; <input TYPE="Radio"
          NAME="stype" VALUE="OR">&quot;OR&quot;</font>


<!--TopList COUNTER--><a target=_top
href="http://top.list.ru/jump?from=89876"><script language="JavaScript"><!--
d=document;a='';a+=';r='+escape(d.referrer)
js=10//--></script><script language="JavaScript1.1"><!--
a+=';j='+navigator.javaEnabled()
js=11//--></script><script language="JavaScript1.2"><!--
s=screen;a+=';s='+s.width+'*'+s.height
a+=';d='+(s.colorDepth?s.colorDepth:s.pixelDepth)
js=12//--></script><script language="JavaScript1.3"><!--
js=13//--></script><script language="JavaScript"><!--
d.write('<img src="http://top.list.ru/counter'+
'?id=89876;t=57;js='+js+a+';rand='+Math.random()+
'" alt="TopList" '+ 'border=0 height=1 width=1>')
if(js>11)d.write('<'+'!-- ')//--></script><noscript><img
src="http://top.list.ru/counter?js=na;id=89876;t=57"
border=0 height=1 width=1
alt="TopList"></noscript><script language="JavaScript"><!--
if(js>11)d.write('--'+'>')//--></script></a><!--TopList COUNTER-->


<a href="http://counter.rambler.ru/top100/"><img src="http://counter.rambler.ru/top100.cnt?163871" alt="Rambler's Top100" width=1 height=1 border=0></a>

<!-- SpyLOG f:0211 --> 
<script language="javascript"> 
u="u1624.10.spylog.com";d=document;nv=navigator;na=nv.appName;p=1; 
bv=Math.round(parseFloat(nv.appVersion)*100); 
n=(na.substring(0,2)=="Mi")?0:1;rn=Math.random();z="p="+p+"&rn="+rn;y=""; 
y+="<a href='http://"+u+"/cnt?f=3&p="+p+"&rn="+rn+"' target=_blank>"; 
y+="<img src='http://"+u+"/cnt?"+z+ "&r="+escape(d.referrer)+"&pg="+escape(window.location.href)+"' border=0 width=1 height=1 alt='SpyLOG'>"; 
y+="</a>"; d.write(y);if(!n) { d.write("<"+"!--"); }//--></script><noscript> 
<a href="http://u1624.10.spylog.com/cnt?f=3&p=1" target=_blank> 
<img src="http://u1624.10.spylog.com/cnt?p=1" alt='SpyLOG' border='0' width=1 height=1 > 
</a></noscript><script language="javascript1.2"><!-- 
if(!n) { d.write("--"+">"); }//--></script> 
<!-- SpyLOG -->


</td>
        </tr>
      </table>
      </td>
      <td align="center"><font style="font-size: 15pt" color="#4904B1" size="4"
      face="Times New Roman">Информационный сервер</font></td>
    </tr>
    <tr>
      <td>


<!-- LBE -->
<script>
// <!--
rand = Math.round((Math.random() * (10000 - 1)));
document.write("<a href=http://www.lbe.ru/cgi-bin/href/castle?" + rand + " target=_blank><img src=http://www.lbe.ru/cgi-bin/banner/castle?" + rand + " width=468 height=60 border=0 alt=LBE ismap></a><br>");
// -->
</script>
<noscript>
                                                                                                                                                                <br>
</noscript>
<!-- LBE -->



      </td>
    </tr>
    <tr>
      <td colspan="2"><table border="0" cellpadding="0" cellspacing="1" width="100%">
        <tr>
          <td align="center" width="11%" bgcolor="#E0E0C6"><a
          href="../www.sources.html"><font color="#000000" size="2">На главную</font></a></td>
          <td align="center" width="20%" bgcolor="#E0E0C6"><a
          href="../subscribe.html"><font color="#000000" size="2">Подписаться на новости</font></a></td>
          <td align="center" width="11%" bgcolor="#E0E0C6"><a href="../cgi-bin/sources/Ultimate.pl"><font color="#000000" size="2">Форум</font></a></td>
          <td align="center" width="11%" bgcolor="#E0E0C6"><a href="../books.html"><font color="#000000" size="2">Книги</font></a></td>
          <td align="center" width="7%" bgcolor="#E0E0C6"><a href="http://chat.vidcenter.ru:82/"><font color="#000000" size="2">Чат</font></a></td>
          <td align="center" width="13%" bgcolor="#E0E0C6"><a href="http://www.countries.ru/"><font color="#000000" size="2">Страны мира</font></a></td>
          <td align="center" width="29%" bgcolor="#E0E0C6"><b>9</b> пользователей на сервере.
</td>
        </tr>
      </table>
      </td>
    </tr>
  </table>
</form>

<div align="center"><center>

<table width="680" cellspacing="0" cellpadding="0">
  <tr>
    <td><hr>
    <h3 align="center"><font color="#a0a099">Технология Drag&amp;Drop</font></h3>
    <hr>
    <p>Автор: <a href="mailto:VolkerBartheld@reetcom.de">Volker Bartheld</a>.</p>
    <p><img border="0" height="259" src="DropTarget.gif" width="508"></p>
    <p><u>Требования:</u> MSVC++6.0 SP3, Win98/2000/NT4(SP5) </p>
    <h3>Описание</h3>
    <p>Данный пример показывает, как просто можно
    добавить в своё приложение технологию Drag&amp;Drop. </p>
    <h3>Как использовать</h3>
    <p>[Файлы, которые нужно импортировать в Ваш
    проект выделены <font color="red">красным</font>, а код,
    который нужно добавить выделен <font color="blue">синим</font>]</p>
    <p>(1)<br>
    Добавьте в Ваш проект файлы объявления классов<br>
    - <font color="red">DropFileArray.cpp / .h</font><br>
    - <font color="red">MyDropTarget.cpp / .h</font></p>
    <p>(2)<br>
    <font color="blue">#include &quot;MyDropTarget.h&quot;</font> в Ваш основной
    файл *.cpp<br>
    (в случае с примером &quot;DropTargetDlg.cpp&quot;.</p>
    <p>(3)<br>
    Объявите сообщения, которые будет получать Ваше
    приложение, если файлы будут перемещены на него:</p>
    <pre>   
[DropTargetDlg.h:]
<font color="blue">// константа сообщения
#define WM_DROPACTION WM_APP+1
// объявление обработчика сообщения
LRESULT OnDropAction(WPARAM wParam = 0, LPARAM lParam = 0);
</font>
[DropTargetDlg.cpp:]
<font
color="blue">BEGIN_MESSAGE_MAP(CDropTargetDlg, CDialog)
  // [...]
  ON_MESSAGE(WM_DROPACTION, OnDropAction)
END_MESSAGE_MAP()
</font></pre>
    <p>(4)<br>
    Добавляем следующее в диалоговую функцию-член
    &nbsp; &quot;OnInitDialog()&quot;<br>
    </p>
    <pre><font color="blue">OleInitialize(NULL); BOOL br =
   m_DropTarget.Register(this);
</font></pre>
    <p>для регистрации Вашего приложения, как
    способного принимать перемещённые файлы. </p>
    <p>(5)<br>
    Добавьте обработчик сообщения для
    перетаскивания:<br>
    </p>
    <pre>[DropTargetDlg.cpp:]
<font color="blue">LRESULT CDropTargetDlg::OnDropAction(WPARAM wParam, LPARAM lParam)
{
// [...]
}  </font></pre>
    <p>(6)<br>
    Объявите переменную-член для нового экземпляра
    класса<br>
    </p>
    <pre>[DropTargetDlg.h:]
<font color="blue">CMyDropTarget m_DropTarget;</font></pre>
    <p>&nbsp;</p>
    <p><b>Описание функций:</b></p>
    <p>Внутри файла, <font color="red">MyDropTarget.cpp / .h</font>
    находятся следующие функции:</p>
    <pre> // возвращает количество файлов, перенесённое на программу. 0 если нет
 int GetNumDroppedFiles(); 
   
 // получает имя (ASCII) первого перенесённого файла
 char* GetFirstDroppedFileName(); 
   
 // получает остальные (позиция iNum) имена перенесённых файлов
 char* GetDroppedFileName(int iNum=0); 
   
 // получает имя файла (wide char)
 wchar_t* GetDroppedFileNameW(int iNum=0); 
   
 // получает имя первого перенесённого файла (wide char)
 wchar_t* GetFirstDroppedFileNameW(); 
   
 // обработчик перетаскивания файла
 BOOL OnDrop( CWnd* pWnd, COleDataObject* pDataObject, 
                    DROPEFFECT dropEffect, CPoint point );</pre>
    <p>OnDrop() возвращает структуру (wide char), содержащую
    список перенесённых файлов через указатель
    COleDataObject. Этот список разделён на простые имена
    файлов, которыми заполнен массив наследованный
    от CArray, не имеющий ограничений на количество
    файлов, которые можно перетащить на приложение.</p>
    <p>Нормальная кодировка используется в Win3.X, 9X, а
    кодировка wide character используется в WinNT4 &amp; W2K. Обе
    они поддерживаются через операторы in-line.</p>
    <h3>Downloads<!-- demo and source files --></h3>
    <p><!-- demo and source files -->Скачать откомпилированный пример <a
    href="DropTargetDemoExe.zip">DropTargetDemoExe.zip</a> - 6.065 kBytes</p>
    <p>Скачать исходник примера <a href="DropTargetDemo.zip">DropTargetDemo.zip</a>
    - 14.618 kBytes</p>
    <p>Скачать исходник <a href="DropTargetSrc.zip">DropTargetSrc.zip</a> -
    3.800 kBytes</p>
    <p><br>
    <br>
    </td>
  </tr>
</table>
</center></div>


<hr>
<div align="center"><center>

<table border="0" cellpadding="0" cellspacing="3" width="468">
  <tr>
    <td width="154"><!-- LBE_LITE --> <script>
// <!--
rand = Math.round((Math.random() * (10000 - 1)));
document.write("<a href=http://lite.lbe.ru/cgi-bin/href/castle?" + rand + " target=_blank><img src=http://lite.lbe.ru/cgi-bin/banner/castle?" + rand + " width=468 height=60 border=0 alt=LBE_LITE ismap></a><br>");
// -->
</script> <noscript> <br>
</noscript><!-- LBE_LITE --></td>
  </tr>
</table>
</center></div>
</body>
</html>
