<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html>

<head>
<style type="text/css">
A.black:link {COLOR: #000000; TEXT-DECORATION: none;FONT-FAMILY: Arial,Verdana,Tahoma,sans-serif; FONT-SIZE: 9pt}
A.black:visited {COLOR: #000000; TEXT-DECORATION: none;FONT-FAMILY: Arial,Verdana,Tahoma,sans-serif; FONT-SIZE: 9pt}
A.black:hover {COLOR: #FFFFFF; TEXT-DECORATION: none;FONT-FAMILY: Arial,Verdana,Tahoma,sans-serif; FONT-SIZE: 9pt}
.b {text-decoration: none; color:#FF0000;} 
.b:hover {color:#7785FF;}
.c {text-decoration: none; color:#000000;} 
.c:hover {color:#FFFFFF;}
 pre {color: blue;}
TD.colon {COLOR: #000000; FONT-FAMILY: "MS Sans Serif", sans-serif; FONT-SIZE: 9pt}
</style>
<meta http-equiv="Content-Type" content="text/html; charset=windows-1251">
<meta content="программирование на Visual Basic, документация, документы, delphi, pascal, cpp, hardware, web, веб-мастер, советы, описания, доки, manual, Java, C, C++, обучение, исходники, odbc, jdbc, programm, protocols, протоколы, общение, форумapplet, java, design, апплет, дизайн, ява, Free, counters, Trackers, Guestbooks, Access Logs, Banners, Graphics, Banner ads, Fonts, Form Mailer, form mailers, graphics, icons, games, freeware, shareware, forms, guestbooks, Java, Javascript, contests, puzzles, fonts, font resources, E-mail programs, reminder services, product samples, samples, Email services, E-mail services, advertising, graphics, free banner ads, free World Wide Web resources, counters, Trackers, Guestbooks, Access Logs, Banners, Graphics, Banner ads, Fonts, Form Mailer, form mailers, graphics, icons, games, freeware, shareware, forms, guestbooks, Java, Javascript, contests, puzzles, fonts, font resources, E-mail programs, reminder services, product samples, samples, Email services, E-mail services, advertising, graphics, free banner ads, free World Wide Web resources" name="keywords">
<meta NAME="RESOURCE-TYPE"
CONTENT="pop hypertext sources hypermedia server scripting shtml phtml html developer code base tools open source web site browser free software webmaster cgi dhtml dynamic content netscape explorer shareware download website construction free tutorial news design maintenance page hit cvs mailing list projects httpd mod_perl mod www htdig xml perl scripts script server-side-include apache database MySQL mysql msql postres postresql module linux online cpp Visual Basic JavaScript delphi wap job informer java opengl directx">
<title>Информационный сервер для программистов - исходники со всего света.</title>
</head>

<body topmargin="0" leftmargin="0" marginwidth="0" marginheigth="0" bgcolor=white>

<form action="/cgi-bin/sources/search/search.pl" method="get" align="left">
  <input type="hidden" name="stpos" value="0"><table border="0" cellpadding="0"
  cellspacing="0" width="750">
    <tr>
      <td valign="top" rowspan="2"><table border="0" cellpadding="0" cellspacing="0" width="287">
        <tr>
          <td colspan="2" bgcolor="#A5E4A7" valign="middle" align="center"><b>WWW.ИСХОДНИКИ.РУ</b></td>
          <td bgcolor="#000080" valign="middle" align="center"><b><font face="Tahoma"
          style="font-size: 8pt" size="-1" color="#FFFFFF">cpp.sources.ru</font></b></td>
        </tr>
        <tr>
          <td bgcolor="#000080" valign="middle" align="center"><b><font face="Tahoma"
          style="font-size: 8pt" size="-1" color="#FFFFFF">java.sources.ru</font></b></td>
          <td bgcolor="#C0C0C0" valign="middle" align="center"><font face="Tahoma"
          style="font-size: 8pt" size="-1"><b>web.sources.ru</b></font></td>
          <td bgcolor="#A5E4A7" valign="middle" align="center"><font face="Tahoma"
          style="font-size: 8pt" size="-1"><b>soft.sources.ru</b></font></td>
        </tr>
        <tr>
          <td bgcolor="#C0C0C0" valign="middle" align="center"><font face="Tahoma"
          style="font-size: 8pt" size="-1"><b>jdbc.sources.ru</b></font></td>
          <td bgcolor="#A5E4A7" valign="middle" align="center"><font face="Tahoma"
          style="font-size: 8pt" size="-1"><b>asp.sources.ru</b></font></td>
          <td bgcolor="#000080" valign="middle" align="center"><b><font face="Tahoma"
          style="font-size: 8pt" size="-1" color="#FFFFFF">api.sources.ru</font></b></td>
        </tr>
      </table>
      <table border="0" cellpadding="0" cellspacing="0" width="100%">
        <tr>
          <td><font style="font-size: 8pt" size="2" face="Tahoma">&nbsp; Поиск по
          программированию :<br>
          </font>&nbsp; <input type="text" size="13" name="query"> <input type="submit"
          value="Поиск"><font size="1"><input
          TYPE="Radio" NAME="stype" VALUE="AND" checked>&quot;AND&quot; <input TYPE="Radio"
          NAME="stype" VALUE="OR">&quot;OR&quot;</font>


<!--TopList COUNTER--><a target=_top
href="http://top.list.ru/jump?from=89876"><script language="JavaScript"><!--
d=document;a='';a+=';r='+escape(d.referrer)
js=10//--></script><script language="JavaScript1.1"><!--
a+=';j='+navigator.javaEnabled()
js=11//--></script><script language="JavaScript1.2"><!--
s=screen;a+=';s='+s.width+'*'+s.height
a+=';d='+(s.colorDepth?s.colorDepth:s.pixelDepth)
js=12//--></script><script language="JavaScript1.3"><!--
js=13//--></script><script language="JavaScript"><!--
d.write('<img src="http://top.list.ru/counter'+
'?id=89876;t=57;js='+js+a+';rand='+Math.random()+
'" alt="TopList" '+ 'border=0 height=1 width=1>')
if(js>11)d.write('<'+'!-- ')//--></script><noscript><img
src="http://top.list.ru/counter?js=na;id=89876;t=57"
border=0 height=1 width=1
alt="TopList"></noscript><script language="JavaScript"><!--
if(js>11)d.write('--'+'>')//--></script></a><!--TopList COUNTER-->


<a href="http://counter.rambler.ru/top100/"><img src="http://counter.rambler.ru/top100.cnt?163871" alt="Rambler's Top100" width=1 height=1 border=0></a>

<!-- SpyLOG f:0211 --> 
<script language="javascript"> 
u="u1624.10.spylog.com";d=document;nv=navigator;na=nv.appName;p=1; 
bv=Math.round(parseFloat(nv.appVersion)*100); 
n=(na.substring(0,2)=="Mi")?0:1;rn=Math.random();z="p="+p+"&rn="+rn;y=""; 
y+="<a href='http://"+u+"/cnt?f=3&p="+p+"&rn="+rn+"' target=_blank>"; 
y+="<img src='http://"+u+"/cnt?"+z+ "&r="+escape(d.referrer)+"&pg="+escape(window.location.href)+"' border=0 width=1 height=1 alt='SpyLOG'>"; 
y+="</a>"; d.write(y);if(!n) { d.write("<"+"!--"); }//--></script><noscript> 
<a href="http://u1624.10.spylog.com/cnt?f=3&p=1" target=_blank> 
<img src="http://u1624.10.spylog.com/cnt?p=1" alt='SpyLOG' border='0' width=1 height=1 > 
</a></noscript><script language="javascript1.2"><!-- 
if(!n) { d.write("--"+">"); }//--></script> 
<!-- SpyLOG -->


</td>
        </tr>
      </table>
      </td>
      <td align="center"><font style="font-size: 15pt" color="#4904B1" size="4"
      face="Times New Roman">Информационный сервер</font></td>
    </tr>
    <tr>
      <td>


<!-- LBE -->
<script>
// <!--
rand = Math.round((Math.random() * (10000 - 1)));
document.write("<a href=http://www.lbe.ru/cgi-bin/href/castle?" + rand + " target=_blank><img src=http://www.lbe.ru/cgi-bin/banner/castle?" + rand + " width=468 height=60 border=0 alt=LBE ismap></a><br>");
// -->
</script>
<noscript>
                                                                                                                                                                <br>
</noscript>
<!-- LBE -->



      </td>
    </tr>
    <tr>
      <td colspan="2"><table border="0" cellpadding="0" cellspacing="1" width="100%">
        <tr>
          <td align="center" width="11%" bgcolor="#E0E0C6"><a
          href="../www.sources.html"><font color="#000000" size="2">На главную</font></a></td>
          <td align="center" width="20%" bgcolor="#E0E0C6"><a
          href="../subscribe.html"><font color="#000000" size="2">Подписаться на новости</font></a></td>
          <td align="center" width="11%" bgcolor="#E0E0C6"><a href="../cgi-bin/sources/Ultimate.pl"><font color="#000000" size="2">Форум</font></a></td>
          <td align="center" width="11%" bgcolor="#E0E0C6"><a href="../books.html"><font color="#000000" size="2">Книги</font></a></td>
          <td align="center" width="7%" bgcolor="#E0E0C6"><a href="http://chat.vidcenter.ru:82/"><font color="#000000" size="2">Чат</font></a></td>
          <td align="center" width="13%" bgcolor="#E0E0C6"><a href="http://www.countries.ru/"><font color="#000000" size="2">Страны мира</font></a></td>
          <td align="center" width="29%" bgcolor="#E0E0C6"><b>7</b> пользователей на сервере.
</td>
        </tr>
      </table>
      </td>
    </tr>
  </table>
</form>

<div align="center"><center>

<table width="680" cellspacing="0" cellpadding="0">
  <tr>
    <td><hr>
    <h3>Окно наподобие левого фрейма Outlook с
    использованием ATL.</h3>
    <p>Автор: <a href="mailto:tkfx@yahoo.com">Alex Blekhman</a><ul>
      <li><a href="WinchCtrl_src.zip">Скачать исходник - 74 Kb</a> </li>
      <li><a href="WinchCtrl_exe.zip">Скачать откомпилированный
        пример - 30 Kb</a><p><img alt="Sample Image - WinchCtrl1.jpg" src="WinchCtrl1.jpg"
        width="240" height="310"> <img alt="WinchCtrl2.jpg" src="WinchCtrl2.jpg" width="240"
        height="298"> </p>
        <h2>Введение</h2>
        <p>Такой эффект ещё используется в Windows, при
        нажатии на кнопку Пуск (Start), если все пункты меню
        не влезают на экран, то высвечиваются
        дополнительные бары, позволяющие прокручивать
        меню.</p>
        <h2>Требования</h2>
        <ul>
          <li>ATL v3.0 и выше </li>
          <li>commctrl.dll версии 4.71 и выше </li>
          <li>поддержку STL включений </li>
          <li>поддержку CRT включений (только для демонстрашки)
          </li>
          <li>любой компилятор C++ совместимый </li>
          <li>MS Platform SDK</li>
        </ul>
        <p>Внимание: данный пример использует ключевый
        слова компилятора MS Visual C++ (типа <code>#pragma</code> ) , но
        они могут быть легко переправлены для любого Win32
        совместимого компилятора.</p>
        <h2>CButtonEx (наследуется от CWindowImpl; файл: ButtonEx.h)</h2>
        <p>Класс <code>CButtonEx </code>позволяет Вам создать кнопки
        с иконками и описанием(caption). Когда кнопка
        активируется, путём установки переменной <em>m_bIsActive
        </em>в true, класс рисует caption используя шрифт bold.
        Иначе используется GUI шрифт по умолчанию.</p>
        <h2>CWinch (наследуется от CWindowImpl; файл: Winch.h,Winch.cpp)</h2>
        <p>Класс CWinch служит для создания собственно
        самого окна наподобие MS Outlook's &quot;Outlook Bar&quot;. Окно
        содержит кнопки-полоски с связанными с ними
        окошками. Когда пользователь кликает на полоску,
        то она перемещается вверх или вниз вместе со
        своим окошком. Вы можете добавлять и удалять
        полоски..</p>
        <h2>CWinchCtrl (наследуется от CWindowImpl; файл: WinchCtrl.h)</h2>
        <p>Класс CWinchCtrl расширяет возвожности данного
        элемента управления, имеет функции-члены типа
        CWinch и обеспечивает доступ к его методам.</p>
        <h2>Как использовать этот элемент управления</h2>
        <p>Во-первых, Вам придётся добавить в Ваши
        исходники файл ‘WinchCtr.h'. Создать объект CWinchCtrl в
        стёке или динамически, используя оператор new.
        Затем вызвать метод Create() класса CWinchCtrl для
        создания окна объекта. Теперь Вы можете
        добавлять или удалять бары, вызывая <code>AppendBar()</code>
        и <code>RemoveBar()</code>, соответственно. Перед
        добавлением, Вам потребуется создать для каждого
        бара своё окно и и связать его с баром. Так же Вы
        можете делать активной любую полосу, вызывая
        функцию <code>ActivateBar()</code>. И в заключении, Вы можете
        получать и устанавливать описание (caption) для
        любой полосы. Запомните, что после добавления
        полосы невозможно будет изменить иконку полосы.
        Если Вы не хотите, чтобы полоса имела иконку, то в
        параметре иконки укажите <code>NULL</code>. Также можно
        создавать полоски без описания (caption).</p>
        <p>Как уже упоминалось, с каждой полоской связано
        отдельное окно, и его Вам придётся создать.
        Каждое такое окно может быть как обычным
        элементом управления Windows, так и пустым окном, а
        также это может быть MFC-окно, имеющее
        определённые ограничения - на чтение. Класс <code>CWinch
        </code>будет отражать все уведомительные сообщения
        (<code>WM_NOTIFY</code>) обратно в созданное окно для
        полоски. Внимание! Если Ваше MFC окно основано на
        отражающих сообщениях MFC (т.е. используя макрос <code>ON_NOTIFY_REFLECT[EX]</code>)
        - это не будет работать. В данном случае Вы должны
        обработать сообщения, отраженные CWinch, используя
        обычную макрокоманду ON_NOTIFY. Чтобы быть уверенным,
        что Вы получили отражённое сообщение, проверьте
        аргумент <i>wParam</i> сообщения <code>WM_NOTIFY</code> – это
        будет тот же идентификатор (ID) с которым было
        создано окно.</p>
        <h2>Настройка</h2>
        <p>В файле ‘Common.h' содержится несколько констант,
        которые упростят Вам жизнь:</p>
        <p><code>CX_ICON</code>, <code>CY_ICON </code>– габариты маленькой
        иконки.</p>
        <p><code>CY_BARBUTTON_HEIGHT </code>– высота полоски. Если
        полоски плохо выглядят в Вашей системе, то данная
        константа как раз поможет откорректировать их.
        Естевственно, полоса не может быть уже, чем
        иконка, которую она содержит.</p>
        <p><code>CX_3DBORDER</code>, <code>CY_3DBORDER </code>– эта константа
        поможет правильно отобразить полоску в нажатом и
        отпущенном состояниях.</p>
        <p><code>ACCELERATE(val) </code>– данная макро-команда
        ускоряет приращение движения, когда встречается
        анимация скроллинга.</p>
        <p><code>SCROLL_SPEED </code>– эта константа определяет
        задержку между кадрами анимации (&quot;frames&quot;) в
        функции SmoothScroll(). Я пробовал различные значения
        под Win2K, WinMe и Win95. Вообще-то, если компьютер
        достаточно мощьный, то оптимальное значение
        будет 15ms.</p>
        <p>WM_INVALIDATE, WM_REDRAW – зарегистрированные сообщения,
        используемые с функцией SendMessageToDescendants(). Можно
        конечно обойтись и без них, но тогда для каждой
        кнопки полоски надо вызывать InvalidareRect() и RedrawWindow().
        Мне это было слишком лениво :).</p>
        <p>ATLVERIFY(exp) – удивительно, что ATL не поддерживает
        данную макро команду. Так что я скопировал один
        из них из MFC.</p>
        <h2>Miscellaneous</h2>
        <p>Я оставил файл .opt в примере, для того, чтобы
        сохранить организацию дерева в ClassView.</p>
      </li>
    </ul>
    <p>&nbsp;</td>
  </tr>
</table>
</center></div></TBODY>


<p align="center"><br>
<br>
</p>


<hr>
<div align="center"><center>

<table border="0" cellpadding="0" cellspacing="3" width="468">
  <tr>
    <td width="154"><!-- LBE_LITE --> <script>
// <!--
rand = Math.round((Math.random() * (10000 - 1)));
document.write("<a href=http://lite.lbe.ru/cgi-bin/href/castle?" + rand + " target=_blank><img src=http://lite.lbe.ru/cgi-bin/banner/castle?" + rand + " width=468 height=60 border=0 alt=LBE_LITE ismap></a><br>");
// -->
</script> <noscript> <br>
</noscript><!-- LBE_LITE --></td>
  </tr>
</table>
</center></div>
</body>
</html>
