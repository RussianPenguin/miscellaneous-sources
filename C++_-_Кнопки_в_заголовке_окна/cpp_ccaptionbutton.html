<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html>

<head>
<title>Информационный сервер для программистов - исходники со всего света.</title>
<style type="text/css">
A.black:link {COLOR: #000000; TEXT-DECORATION: none;FONT-FAMILY: Arial,Verdana,Tahoma,sans-serif; FONT-SIZE: 9pt}
A.black:visited {COLOR: #000000; TEXT-DECORATION: none;FONT-FAMILY: Arial,Verdana,Tahoma,sans-serif; FONT-SIZE: 9pt}
A.black:hover {COLOR: #FFFFFF; TEXT-DECORATION: none;FONT-FAMILY: Arial,Verdana,Tahoma,sans-serif; FONT-SIZE: 9pt}
.b {text-decoration: none; color:#FF0000;}   
.b:hover {color:#7785FF;}
.c {text-decoration: none; color:#000000;}   
.c:hover {color:#FFFFFF;}
 pre {color: blue;}
TD.colon {COLOR: #000000; FONT-FAMILY: "MS Sans Serif", sans-serif; FONT-SIZE: 9pt}
</style>

<meta http-equiv="Content-Type" content="text/html; charset=windows-1251">
<meta content="программирование на Visual Basic, документация, документы, delphi, pascal, cpp, hardware, web, веб-мастер, советы, описания, доки, manual, Java, C, C++, обучение, исходники, odbc, jdbc, programm, protocols, протоколы, общение, форумapplet, java, design, апплет, дизайн, ява, Free, counters, Trackers, Guestbooks, Access Logs, Banners, Graphics, Banner ads, Fonts, Form Mailer, form mailers, graphics, icons, games, freeware, shareware, forms, guestbooks, Java, Javascript, contests, puzzles, fonts, font resources, E-mail programs, reminder services, product samples, samples, Email services, E-mail services, advertising, graphics, free banner ads, free World Wide Web resources, counters, Trackers, Guestbooks, Access Logs, Banners, Graphics, Banner ads, Fonts, Form Mailer, form mailers, graphics, icons, games, freeware, shareware, forms, guestbooks, Java, Javascript, contests, puzzles, fonts, font resources, E-mail programs, reminder services, product samples, samples, Email services, E-mail services, advertising, graphics, free banner ads, free World Wide Web resources" name="keywords">
<meta NAME="RESOURCE-TYPE"CONTENT="pop hypertext sources hypermedia server scripting shtml phtml html developer code base tools open source web site browser free software webmaster cgi dhtml dynamic content netscape explorer shareware download website construction free tutorial news design maintenance page hit cvs mailing list projects httpd mod_perl mod www htdig xml perl scripts script server-side-include apache database MySQL mysql msql postres postresql module linux online cpp Visual Basic JavaScript delphi wap job informer java opengl directx">
</head>

<body topmargin="0" leftmargin="0" marginwidth="0" marginheigth="0" bgcolor=white>




<form action="/cgi-bin/sources/search/search.pl" method="get" align="left">
</form>

<div align="center"><center>

<table width="680" cellspacing="0" cellpadding="0">
  <tr>
    <td><p align="center">&nbsp;</p>
    <h3 align="center"><font color="#a0a099">Кнопки в заголовке окна </font></h3>
    <hr>
    <p>Автор: <a href="mailto:amistry@am-productions.yi.org">Anish Mistry</a>.</p>
    <p><img src="ccaptionbutton.gif" width="361" height="165"></p>
    <p><u>Требования: VC6 SP4, W2K SP1</u> - Может не работать в
    Win95 с DirectX :). </p>
    <p>Здесь представлен класс под названием CCaptionButton,
    задача которого упростить создание кнопок<br>
    в заголовке окна. Изначально была идея заменить
    существующие привычные кнопки (Minimize,<br>
    Maximize,Close), но было решено пойти более творческим
    путём, и использовать битмапы, которые<br>
    позволяли бы создавать свой собственный
    уникальный интерфейс.</p>
    <p>Возможности: <ul>
      <li>Подсказки 
 
      <li>Динамическое изменение 
 
      <li>Динамическое добавление 
 
      <li>Динамическое удаление 
 
      <li>Уведомление о нажатии 
 
      <li>Гибкий дизайн</li>
    </ul>
    <p>&nbsp;</p>
    <p>Вот небольшой пример создания кнопок при
    помощи класса CCaptionButton:</p>
    <p><!-- create more blocks of article text as needed separated --><!-- with the <p> HTML tag --><!-- with the <p> HTML tag --> <!-- start a block of source code --> </p>
    <pre>// объявляем переменную класса
CCaptionButton cbExtra;

// подкласс окна
cbExtra.Init(hWnd);

// устанавливаем тип заголовка CB_APPWINDOW/CB_TOOLWINDOW
cbExtra.SetCaptionType(CB_APPWINDOW);

// какой тип окна CB_SDIMDI/CB_DIALOG
cbExtra.SetWindowType(CB_SDIMDI);

// устанавливаем количество заголовков (Minimize/Maximize/Close)
cbExtra.SetNumOfDefaultCaptions(3);

// устанавливаем прозрачный цвет картинок
COLORREF crTransparent = RGB(255,0,255);
cbExtra.SetTransparentColor(crTransparent);

// устанавливаем bitmap который будет отображаться
cbExtra.SetSelectionBitmap((HBITMAP)LoadImage(hInstance,
                           MAKEINTRESOURCE(IDB_SELECTION),
                           IMAGE_BITMAP,
                           0,0,
                           LR_LOADMAP3DCOLORS | LR_DEFAULTCOLOR));

// создаём bitmaps при наведении мышки (можно конечно загружать его
// напрямую, но данный способ экономит память)
HBITMAP hMouseOverBitmap = (HBITMAP)LoadImage(hInstance,
                            MAKEINTRESOURCE(IDB_MOUSEOVER),
                            IMAGE_BITMAP,
                            0,0,
                            LR_LOADMAP3DCOLORS | LR_DEFAULTCOLOR);

// кнопка AM Productions
HBITMAP hCaptionAMBitmap = (HBITMAP)LoadImage(hInstance,
                            MAKEINTRESOURCE(IDB_BITMAP_AM),
                            IMAGE_BITMAP,
                            0,0,
                            LR_LOADMAP3DCOLORS | LR_DEFAULTCOLOR);

HBITMAP hCaptionAMBitmapHilite = 
 CCaptionButton::CombineBitmaps(hCaptionAMBitmap,
                                hMouseOverBitmap,
                                crTransparent);

// кнопка 2
HBITMAP hCaption2Bitmap = (HBITMAP)LoadImage(hInstance,
                           MAKEINTRESOURCE(IDB_BITMAP2),
                           IMAGE_BITMAP,
                           0,0,
                           LR_LOADMAP3DCOLORS | LR_DEFAULTCOLOR);

HBITMAP hCaption2BitmapHilite = 
 CCaptionButton::CombineBitmaps(hCaption2Bitmap,
                                hMouseOverBitmap,
                                crTransparent);

// кнопка 3
HBITMAP hCaption3Bitmap = (HBITMAP)LoadImage(hInstance,
                           MAKEINTRESOURCE(IDB_BITMAP3),
                           IMAGE_BITMAP,
                           0,0,
                           LR_LOADMAP3DCOLORS | LR_DEFAULTCOLOR);

HBITMAP hCaption3BitmapHilite = 
 CCaptionButton::CombineBitmaps(hCaption3Bitmap,
                                hMouseOverBitmap,
                                crTransparent);

// создаём кнопку с ID =   
 

  


    


    


    


    
   


     

                           
                           
                           
                             

         
      
   
                            
                            
                            
                              

   
   
                            
                            
                            
                              

   
 
                                
                                

  
   
                           
                           
                           
                             

   
 
                                
                                

  
   
                           
                           
                           
                             

   
 
                                
                                

        
 

  


    


    


    


    
   


     

                           
                           
                           
                             

         
      
   
                            
                            
                            
                              

   
   
                            
                            
                            
                              

   
 
                                
                                

  
   
                           
                           
                           
                             

   
 
                                
                                

  
   
                           
                           
                           
                             

   
 
                                
                                

      1, битмап для наведения мышки для
// hCaptionAMBitmapHilite, нормальный bitmap для hCaptionAMBitmap,
// и текст подсказки "AM Productions - Visit Now!"
cbExtra.New(1,hCaptionAMBitmapHilite,hCaptionAMBitmap,
                                  "AM Productions - Visit Now!");
cbExtra.New(2,hCaption2BitmapHilite,hCaption2Bitmap,"Caption 2");
cbExtra.New(3,hCaption3BitmapHilite,hCaption3Bitmap,"Caption 3");

// загружаем их напрямую из ресурсов
cbExtra.New(4,
            (HBITMAP)LoadImage(hInstance,
                               MAKEINTRESOURCE(IDB_BITMAP5),
                               IMAGE_BITMAP,
                               0,0,
                               LR_LOADMAP3DCOLORS | LR_DEFAULTCOLOR),
            (HBITMAP)LoadImage(hInstance,
                               MAKEINTRESOURCE(IDB_BITMAP6),
                               IMAGE_BITMAP,
                               0,0,
                               LR_LOADMAP3DCOLORS | LR_DEFAULTCOLOR),
"Caption 4");
</pre>
    <p>Так же возникает вопрос, как узнать была ли
    нажата кнопка ? Ответ: если на кнопке кликнуть, то
    вызывается событие WM_CBLBUTTONCLICKED и посылается окну
    с кнопкой. WPARAM этого сообщения содержит ID кнопки,
    которая была нажата, а LPARAM содержит структуру POINT
    с координатами курсора (если вам понадобится
    отображать всплывающее меню).</p>
    <p>Для того, чтобы добавить кнопку достаточно
    вызвать функцию New(), только не забудьте в
    качестве пятого параметра указать номер места
    расположения кнопки (справа на лево). Так же не
    сложно изменять существующие кнопки.</p>
    <pre>// изменяем кнопку
cbExtra.Replace(nCurrentCaptionID,
                nNewCaptionID,
                hNewMouseoverBitmap,
                hNewNormalBitmap,
                pNewToolTipText);
</pre>
    <p>И, соответственно удалять их.</p>
    <pre>// удаление кнопки
cbExtra.Delete(nCurrentCaptionID);
</pre>
    <h3>Downloads</h3>
    <p><a href="ccaptionbutton.zip">Скачать демонстрашку и
    исходник - 42 Kb</a> </p>
    <p>&nbsp;</p>
    <p>&nbsp;</p></td>
  </tr>
</table>
</center></div>


<hr>
</body>
</html>