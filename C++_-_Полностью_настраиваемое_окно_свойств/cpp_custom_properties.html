<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html>

<head>
<style type="text/css">
A.black:link {COLOR: #000000; TEXT-DECORATION: none;FONT-FAMILY: Arial,Verdana,Tahoma,sans-serif; FONT-SIZE: 9pt}
A.black:visited {COLOR: #000000; TEXT-DECORATION: none;FONT-FAMILY: Arial,Verdana,Tahoma,sans-serif; FONT-SIZE: 9pt}
A.black:hover {COLOR: #FFFFFF; TEXT-DECORATION: none;FONT-FAMILY: Arial,Verdana,Tahoma,sans-serif; FONT-SIZE: 9pt}
.b {text-decoration: none; color:#FF0000;} 
.b:hover {color:#7785FF;}
.c {text-decoration: none; color:#000000;} 
.c:hover {color:#FFFFFF;}
 pre {color: blue;}
TD.colon {COLOR: #000000; FONT-FAMILY: "MS Sans Serif", sans-serif; FONT-SIZE: 9pt}
</style>
<meta http-equiv="Content-Type" content="text/html; charset=windows-1251">
<meta content="программирование на Visual Basic, документация, документы, delphi, pascal, cpp, hardware, web, веб-мастер, советы, описания, доки, manual, Java, C, C++, обучение, исходники, odbc, jdbc, programm, protocols, протоколы, общение, форумapplet, java, design, апплет, дизайн, ява, Free, counters, Trackers, Guestbooks, Access Logs, Banners, Graphics, Banner ads, Fonts, Form Mailer, form mailers, graphics, icons, games, freeware, shareware, forms, guestbooks, Java, Javascript, contests, puzzles, fonts, font resources, E-mail programs, reminder services, product samples, samples, Email services, E-mail services, advertising, graphics, free banner ads, free World Wide Web resources, counters, Trackers, Guestbooks, Access Logs, Banners, Graphics, Banner ads, Fonts, Form Mailer, form mailers, graphics, icons, games, freeware, shareware, forms, guestbooks, Java, Javascript, contests, puzzles, fonts, font resources, E-mail programs, reminder services, product samples, samples, Email services, E-mail services, advertising, graphics, free banner ads, free World Wide Web resources" name="keywords">
<meta NAME="RESOURCE-TYPE"
CONTENT="pop hypertext sources hypermedia server scripting shtml phtml html developer code base tools open source web site browser free software webmaster cgi dhtml dynamic content netscape explorer shareware download website construction free tutorial news design maintenance page hit cvs mailing list projects httpd mod_perl mod www htdig xml perl scripts script server-side-include apache database MySQL mysql msql postres postresql module linux online cpp Visual Basic JavaScript delphi wap job informer java opengl directx">
<title>Информационный сервер для программистов - исходники со всего света.</title>
</head>

<body topmargin="0" leftmargin="0" marginwidth="0" marginheigth="0" bgcolor=white>

<form action="/cgi-bin/sources/search/search.pl" method="get" align="left">
  <input type="hidden" name="stpos" value="0"><table border="0" cellpadding="0"
  cellspacing="0" width="750">
    <tr>
      <td valign="top" rowspan="2"><table border="0" cellpadding="0" cellspacing="0" width="287">
        <tr>
          <td colspan="2" bgcolor="#A5E4A7" valign="middle" align="center"><b>WWW.ИСХОДНИКИ.РУ</b></td>
          <td bgcolor="#000080" valign="middle" align="center"><b><font face="Tahoma"
          style="font-size: 8pt" size="-1" color="#FFFFFF">cpp.sources.ru</font></b></td>
        </tr>
        <tr>
          <td bgcolor="#000080" valign="middle" align="center"><b><font face="Tahoma"
          style="font-size: 8pt" size="-1" color="#FFFFFF">java.sources.ru</font></b></td>
          <td bgcolor="#C0C0C0" valign="middle" align="center"><font face="Tahoma"
          style="font-size: 8pt" size="-1"><b>web.sources.ru</b></font></td>
          <td bgcolor="#A5E4A7" valign="middle" align="center"><font face="Tahoma"
          style="font-size: 8pt" size="-1"><b>soft.sources.ru</b></font></td>
        </tr>
        <tr>
          <td bgcolor="#C0C0C0" valign="middle" align="center"><font face="Tahoma"
          style="font-size: 8pt" size="-1"><b>jdbc.sources.ru</b></font></td>
          <td bgcolor="#A5E4A7" valign="middle" align="center"><font face="Tahoma"
          style="font-size: 8pt" size="-1"><b>asp.sources.ru</b></font></td>
          <td bgcolor="#000080" valign="middle" align="center"><b><font face="Tahoma"
          style="font-size: 8pt" size="-1" color="#FFFFFF">api.sources.ru</font></b></td>
        </tr>
      </table>
      <table border="0" cellpadding="0" cellspacing="0" width="100%">
        <tr>
          <td><font style="font-size: 8pt" size="2" face="Tahoma">&nbsp; Поиск по
          программированию :<br>
          </font>&nbsp; <input type="text" size="13" name="query"> <input type="submit"
          value="Поиск"><font size="1"><input
          TYPE="Radio" NAME="stype" VALUE="AND" checked>&quot;AND&quot; <input TYPE="Radio"
          NAME="stype" VALUE="OR">&quot;OR&quot;</font>


<!--TopList COUNTER--><a target=_top
href="http://top.list.ru/jump?from=89876"><script language="JavaScript"><!--
d=document;a='';a+=';r='+escape(d.referrer)
js=10//--></script><script language="JavaScript1.1"><!--
a+=';j='+navigator.javaEnabled()
js=11//--></script><script language="JavaScript1.2"><!--
s=screen;a+=';s='+s.width+'*'+s.height
a+=';d='+(s.colorDepth?s.colorDepth:s.pixelDepth)
js=12//--></script><script language="JavaScript1.3"><!--
js=13//--></script><script language="JavaScript"><!--
d.write('<img src="http://top.list.ru/counter'+
'?id=89876;t=57;js='+js+a+';rand='+Math.random()+
'" alt="TopList" '+ 'border=0 height=1 width=1>')
if(js>11)d.write('<'+'!-- ')//--></script><noscript><img
src="http://top.list.ru/counter?js=na;id=89876;t=57"
border=0 height=1 width=1
alt="TopList"></noscript><script language="JavaScript"><!--
if(js>11)d.write('--'+'>')//--></script></a><!--TopList COUNTER-->


<a href="http://counter.rambler.ru/top100/"><img src="http://counter.rambler.ru/top100.cnt?163871" alt="Rambler's Top100" width=1 height=1 border=0></a>

<!-- SpyLOG f:0211 --> 
<script language="javascript"> 
u="u1624.10.spylog.com";d=document;nv=navigator;na=nv.appName;p=1; 
bv=Math.round(parseFloat(nv.appVersion)*100); 
n=(na.substring(0,2)=="Mi")?0:1;rn=Math.random();z="p="+p+"&rn="+rn;y=""; 
y+="<a href='http://"+u+"/cnt?f=3&p="+p+"&rn="+rn+"' target=_blank>"; 
y+="<img src='http://"+u+"/cnt?"+z+ "&r="+escape(d.referrer)+"&pg="+escape(window.location.href)+"' border=0 width=1 height=1 alt='SpyLOG'>"; 
y+="</a>"; d.write(y);if(!n) { d.write("<"+"!--"); }//--></script><noscript> 
<a href="http://u1624.10.spylog.com/cnt?f=3&p=1" target=_blank> 
<img src="http://u1624.10.spylog.com/cnt?p=1" alt='SpyLOG' border='0' width=1 height=1 > 
</a></noscript><script language="javascript1.2"><!-- 
if(!n) { d.write("--"+">"); }//--></script> 
<!-- SpyLOG -->


</td>
        </tr>
      </table>
      </td>
      <td align="center"><font style="font-size: 15pt" color="#4904B1" size="4"
      face="Times New Roman">Информационный сервер</font></td>
    </tr>
    <tr>
      <td>


<!-- LBE -->
<script>
// <!--
rand = Math.round((Math.random() * (10000 - 1)));
document.write("<a href=http://www.lbe.ru/cgi-bin/href/castle?" + rand + " target=_blank><img src=http://www.lbe.ru/cgi-bin/banner/castle?" + rand + " width=468 height=60 border=0 alt=LBE ismap></a><br>");
// -->
</script>
<noscript>
                                                                                                                                                                <br>
</noscript>
<!-- LBE -->



      </td>
    </tr>
    <tr>
      <td colspan="2"><table border="0" cellpadding="0" cellspacing="1" width="100%">
        <tr>
          <td align="center" width="11%" bgcolor="#E0E0C6"><a
          href="../www.sources.html"><font color="#000000" size="2">На главную</font></a></td>
          <td align="center" width="20%" bgcolor="#E0E0C6"><a
          href="../subscribe.html"><font color="#000000" size="2">Подписаться на новости</font></a></td>
          <td align="center" width="11%" bgcolor="#E0E0C6"><a href="../cgi-bin/sources/Ultimate.pl"><font color="#000000" size="2">Форум</font></a></td>
          <td align="center" width="11%" bgcolor="#E0E0C6"><a href="../books.html"><font color="#000000" size="2">Книги</font></a></td>
          <td align="center" width="7%" bgcolor="#E0E0C6"><a href="http://chat.vidcenter.ru:82/"><font color="#000000" size="2">Чат</font></a></td>
          <td align="center" width="13%" bgcolor="#E0E0C6"><a href="http://www.countries.ru/"><font color="#000000" size="2">Страны мира</font></a></td>
          <td align="center" width="29%" bgcolor="#E0E0C6"><b>13</b> пользователей на сервере.
</td>
        </tr>
      </table>
      </td>
    </tr>
  </table>
</form>

<div align="center"><center>

<table width="680" cellspacing="0" cellpadding="0">
  <tr>
    <td><hr>
    <h3 align="center"><font color="#a0a099">Полностью настраиваемое
    окно свойств. </font></h3>
    <hr>
    <p>Автор <a href="mailto:brett@bisk.com">Brett R. Mitchell</a>. </p>
    <p>Иногда возникает потребность в окошке свойств,
    которое можно было бы полностью настроить по
    своему вкусу. А так же, чтобы оно поддерживало
    редактируемые combo боксы и посылало сообщения,
    когда свойство было изменено. давайте рассмотрим
    пример подробнее ... </p>
    <p><script language="JavaScript">
//<!--
picUrl = new Array(2);
picUrl[0]="PropertyWindow-1.gif"
picUrl[1]="PropertyWindow-2.gif"
function showupdate(photoIndex)
{
document['bigPhoto'].src = picUrl[photoIndex];
return;
}
//-->
</script> </p>
    <table border="0" cellPadding="0" cellSpacing="0">
<TBODY>
      <tr>
        <td vAlign="top"><table>
<TBODY>
          <tr>
            <b><td>Нажмите на картинку,<br>
            чтобы увеличить её</b></td>
          </tr>
          <tr>
            <td><table cellPadding="0" cellSpacing="0" width="110">
<TBODY>
              <tr>
                <td height="80" width="104"><script language="JavaScript">
            //<!--
            document.write('<a href="javascript: showupdate(0)">')
            //-->
          </script> <a
                href="javascript: showupdate(0)"><img border="1" height="72"
                src="PropertyWindow-1.gif" width="96"
                color="#CCCCCC"></a> </td>
              </tr>
              <tr>
                <td height="80" width="104"><script language="JavaScript">
          //<!--
          document.write('<a href="javascript: showupdate(1)">')
          //-->
          </script> <a
                href="javascript: showupdate(1)"><img border="1" height="72"
                src="PropertyWindow-2.gif" width="96"
                color="#CCCCCC"></a></td>
              </tr>
              <tr>
                <td height="80" width="104"></td>
              </tr>
</TBODY>
            </table>
            </td>
            <td></td>
          </tr>
</TBODY>
        </table>
        </td>
        <td vAlign="top"><img border="1" name="bigPhoto"
        src="http://codeguru.earthweb.com/listview/PropertyWindow-1.gif"> </td>
        <td width="20"></td>
      </tr>
</TBODY>
    </table>
    <p>Данный элемент управления наследован от CListBox,
    следственно доступны все функции CListbox. Так же
    доступны следующие функции для изменения вида
    окошка свойств:</p>
    <pre>void	SetFont(CFont* pFont);
void	SetBkColor(COLORREF crColor);
void	SetPropertyBkColor(COLORREF crColor);
void	SetHighlightColor(COLORREF crColor);
void	SetLineStyle(COLORREF crColor, int nStyle = PS_SOLID);
void	SetBoldSelection(BOOL bBoldSelection);
void	SetTextColor(COLORREF crColor);
void	SetTextHighlightColor(COLORREF crColor);
void	SetPropertyTextColor(COLORREF crColor);</pre>
    <p>Следующая группа функций обеспечивает
    способность добавлять к элементу управления
    различные дополнительные свойства. В данный
    момент поддерживаются Combo Боксы, текстовые поля,
    переключатели, поля выбора шрифта, поля выбора
    цвета и Статические(Static) поля. </p>
    <pre>BOOL	AddString(CString csText);

BOOL	AddString(CString csText, int nType, 
                CString csData, int nPropertySelected = 0, 
                int nAlignment = DT_LEFT, 
                BOOL bComboEditable = FALSE, 
                BOOL bComboSorted = FALSE);

BOOL	AddString(CString csText, COLORREF crColor, 
                int nAlignment = DT_LEFT);

BOOL	AddString(CString csText, CFont* pFont, 
                int nAlignment = DT_LEFT);</pre>
    <p>Единственно, что тут нуждается в объяснении -
    это вторая функция 'AddString'. Параметр 'nType' может
    быть как ID_PROPERTY_TEXT так и ID_PROPERTY_STATIC или ID_PROPERTY_BOOL
    или ID_PROPERTY_PATH или ID_PROPERTY_COMBO_LIST. Шрифт и Цвет
    используют другие две функции 'AddString'. Параметр
    'csData' должен быть отформатирован символом
    разделителем '!'. (смотрите пример ниже). Другой
    параметр, который нуждается в объяснении - это
    'nPropertySelected'. Он используется для установки
    выбранного пункта в combobox либо для установки bool
    значения в true или false. (смотрите пример ниже) </p>
    <p>Чтобы получить данные из свойств, используются
    следующие функции.</p>
    <pre>bool	GetProperty(int nItem, CString* pText);	
bool	GetProperty(int nItem, bool* bValue);	
bool	GetProperty(int nItem, COLORREF* crColor);	   
bool	GetProperty(int nItem, LOGFONT*	LogFont);
bool	GetProperty(int nItem, CStringArray* pArray, 
                  int* SelectedItem = NULL);
bool	GetProperty(int nItem, int* SelectedItem, 
                  CString* csText = NULL);</pre>
    <p>И Заключительная возможность этого элемента
    управления - это возможность отправлять
    родительскому окну сообщение о том, что свойство
    было изменено. ID сообщения - ID_PROPERTY_CHANGED. Ловить
    такое сообщение в родительском окне нужно
    стандартной макро командой ON_MESSAGE. Первый
    параметр - это элемент, который был изменён.
    Второй - это тип изменённого элемента. (COMBO, TEXT, и т.д.
    ) Вот пример. </p>
    <p>Объявляем сообщение, которое будем ловить в
    BEGIN_MESSAGE_MAP: </p>
    <pre>ON_MESSAGE(ID_PROPERTY_CHANGED, OnPropertyChanged)</pre>
    <p>&nbsp;</p>
    <p>Объявление функции: </p>
    <pre>LONG CParentClass::OnPropertyChanged(UINT wItemChanged, 
                                     LONG lPropertyType)</pre>
    <p>Объявление функции .h файле родительского
    класса: </p>
    <pre>afx_msg LONG OnPropertyChanged(UINT wItemChanged, LONG lPropertyType);</pre>
    <p>Далее следует пример, как создать интерфейс
    пользователя, добавить свойства и получить
    значения из элемента управления. </p>
    <pre><span class="codeComment">// Создаём шрифт Списка(list box)</span>
m_pListBoxFont = new CFont();
m_pListBoxFont-&gt;CreateFont(14, 0, 0, 0, FW_NORMAL, 0, 0, 0,
                           ANSI_CHARSET, OUT_TT_PRECIS,
                           CLIP_DEFAULT_PRECIS, DEFAULT_QUALITY, 
                           VARIABLE_PITCH | FF_SWISS,
                           &quot;arial&quot;);	
	
<span
class="codeComment">// Создаём шрифт Свойства(Property)</span>
m_pPropertyFont = new CFont();
m_pPropertyFont-&gt;CreateFont(16, 0, 0, 0, FW_NORMAL, 0, 0, 0, 
                            ANSI_CHARSET, OUT_TT_PRECIS, 
                            CLIP_DEFAULT_PRECIS, DEFAULT_QUALITY, 
                            VARIABLE_PITCH | FF_SWISS, &quot;system&quot;);	
	
<span
class="codeComment">// Создаём элемент управления</span>
m_pPropertyListCtrl = new CPropertyListCtrl();
m_pPropertyListCtrl-&gt;Create(WS_CHILD|WS_BORDER|WS_VISIBLE
                            |LBS_NOTIFY|WS_VSCROLL|WS_HSCROLL
                            |LBS_HASSTRINGS|LBS_OWNERDRAWFIXED, 
                            CRect(200,100,550,300), this, 
                            ID_PROPERTYLIST);
	
<span
class="codeComment">// Устанавливаем некоторые атрибуты(Completly Optional)</span>
m_pPropertyListCtrl-&gt;SetFont(m_pListBoxFont);
m_pPropertyListCtrl-&gt;SetBkColor(RGB(214,227,239));
m_pPropertyListCtrl-&gt;SetTextColor(RGB(74,109,132));
m_pPropertyListCtrl-&gt;SetTextHighlightColor(RGB(80,80,80));
m_pPropertyListCtrl-&gt;SetHighlightColor(RGB(246,246,220));
m_pPropertyListCtrl-&gt;SetPropertyBkColor(RGB(255,255,255));
m_pPropertyListCtrl-&gt;SetPropertyTextColor(RGB(0,0,192));
m_pPropertyListCtrl-&gt;SetBoldSelection(TRUE);
m_pPropertyListCtrl-&gt;SetLineStyle(RGB(74,109,132), PS_SOLID);

<span
class="codeComment">// Добавляем свойства(Properties)</span>
m_pPropertyListCtrl-&gt;AddString(&quot;Static Text&quot;,
                               ID_PROPERTY_STATIC,
                               &quot;C:\\Windows&quot;, 0, DT_RIGHT);

m_pPropertyListCtrl-&gt;AddString(&quot;Text Property&quot;,
                               ID_PROPERTY_TEXT,
                               &quot;This is some text&quot;, 0, DT_RIGHT);

m_pPropertyListCtrl-&gt;AddString(&quot;Toggle Property&quot;,
                               ID_PROPERTY_BOOL,
                               &quot;True!False&quot;, 0, DT_RIGHT);

m_pPropertyListCtrl-&gt;AddString(&quot;Color Property&quot;,
                               RGB(57,
                               09,165), DT_RIGHT);

m_pPropertyListCtrl-&gt;AddString(&quot;Font Property&quot;,
                               m_pPropertyFont,
                               DT_RIGHT);

m_pPropertyListCtrl-&gt;AddString(&quot;File Property&quot;,
                               ID_PROPERTY_PATH,
                               &quot;D:\\Code\\C++\\32bit\\&quot;
                               &quot;Programs\\Blackjack\\Images&quot;
                               &quot;\\Dealer.bmp!Bitmap Files &quot;
                               &quot;(*.BMP)|*.bmp|All Files (*.*)&quot;
                               &quot;|*.*|&quot;, 0, DT_RIGHT);

m_pPropertyListCtrl-&gt;AddString(&quot;Combobox Property&quot;,
                               ID_PROPERTY_COMBO_LIST,
                               &quot;Porsche!BMW!Mercedes!Lotus!Ford!&quot;
                               &quot;Chevy!Kia!Dodge!Nissan!Toyota&quot;, 
                               2, DT_RIGHT, TRUE, TRUE);


<span
class="codeComment">// Получаем Свойства(Properties)</span>
CString csText;
m_pPropertyListCtrl-&gt;GetProperty(0, &amp;csText);	

<span
class="codeComment">// Переключатель</span>
bool bValue;
m_pPropertyListCtrl-&gt;GetProperty(1, &amp;bValue);
	
<span
class="codeComment">// Цвет</span>
COLORREF crColor;
m_pPropertyListCtrl-&gt;GetProperty(2, &amp;crColor);

<span
class="codeComment">// Шрифт</span>
LOGFONT lf;
m_pPropertyListCtrl-&gt;GetProperty(3, &amp;lf);

<span
class="codeComment">// Combo Box</span>
CStringArray Items;
m_pPropertyListCtrl-&gt;GetProperty(5, &amp;Items);

<span
class="codeComment">// Combo Box (получаем индекс выбранного пункта и текст)</span>
int nSelectedItem;
m_pPropertyListCtrl-&gt;GetProperty(5, &amp;nSelectedItem, &amp;csText);</pre>
    <h3>Downloads</h3>
    <a href="PropertyWindow.zip"><p>Скачать исходник - 9 Kb</a><br>
    <a href="PropertyWindow_demo.zip">Скачать демонстрационный
    пример - 26 Kb</a> </p>
    <p><br>
    <br>
    </td>
  </tr>
</table>
</center></div>


<hr>
<div align="center"><center>

<table border="0" cellpadding="0" cellspacing="3" width="468">
  <tr>
    <td width="154"><!-- LBE_LITE --> <script>
// <!--
rand = Math.round((Math.random() * (10000 - 1)));
document.write("<a href=http://lite.lbe.ru/cgi-bin/href/castle?" + rand + " target=_blank><img src=http://lite.lbe.ru/cgi-bin/banner/castle?" + rand + " width=468 height=60 border=0 alt=LBE_LITE ismap></a><br>");
// -->
</script> <noscript> <br>
</noscript><!-- LBE_LITE --></td>
  </tr>
</table>
</center></div>
</body>
</html>
