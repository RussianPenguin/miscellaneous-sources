<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html>

<head>
<style type="text/css">
A.black:link {COLOR: #000000; TEXT-DECORATION: none;FONT-FAMILY: Arial,Verdana,Tahoma,sans-serif; FONT-SIZE: 9pt}
A.black:visited {COLOR: #000000; TEXT-DECORATION: none;FONT-FAMILY: Arial,Verdana,Tahoma,sans-serif; FONT-SIZE: 9pt}
A.black:hover {COLOR: #FFFFFF; TEXT-DECORATION: none;FONT-FAMILY: Arial,Verdana,Tahoma,sans-serif; FONT-SIZE: 9pt}
.b {text-decoration: none; color:#FF0000;} 
.b:hover {color:#7785FF;}
.c {text-decoration: none; color:#000000;} 
.c:hover {color:#FFFFFF;}
 pre {color: blue;}
TD.colon {COLOR: #000000; FONT-FAMILY: "MS Sans Serif", sans-serif; FONT-SIZE: 9pt}
</style>
<meta http-equiv="Content-Type" content="text/html; charset=windows-1251">
<meta content="программирование на Visual Basic, документация, документы, delphi, pascal, cpp, hardware, web, веб-мастер, советы, описания, доки, manual, Java, C, C++, обучение, исходники, odbc, jdbc, programm, protocols, протоколы, общение, форумapplet, java, design, апплет, дизайн, ява, Free, counters, Trackers, Guestbooks, Access Logs, Banners, Graphics, Banner ads, Fonts, Form Mailer, form mailers, graphics, icons, games, freeware, shareware, forms, guestbooks, Java, Javascript, contests, puzzles, fonts, font resources, E-mail programs, reminder services, product samples, samples, Email services, E-mail services, advertising, graphics, free banner ads, free World Wide Web resources, counters, Trackers, Guestbooks, Access Logs, Banners, Graphics, Banner ads, Fonts, Form Mailer, form mailers, graphics, icons, games, freeware, shareware, forms, guestbooks, Java, Javascript, contests, puzzles, fonts, font resources, E-mail programs, reminder services, product samples, samples, Email services, E-mail services, advertising, graphics, free banner ads, free World Wide Web resources" name="keywords">
<meta NAME="RESOURCE-TYPE"
CONTENT="pop hypertext sources hypermedia server scripting shtml phtml html developer code base tools open source web site browser free software webmaster cgi dhtml dynamic content netscape explorer shareware download website construction free tutorial news design maintenance page hit cvs mailing list projects httpd mod_perl mod www htdig xml perl scripts script server-side-include apache database MySQL mysql msql postres postresql module linux online cpp Visual Basic JavaScript delphi wap job informer java opengl directx">
<title>Информационный сервер для программистов - исходники со всего света.</title>
</head>

<body topmargin="0" leftmargin="0" marginwidth="0" marginheigth="0" bgcolor=white>

<form action="/cgi-bin/sources/search/search.pl" method="get" align="left">
  <input type="hidden" name="stpos" value="0"><table border="0" cellpadding="0"
  cellspacing="0" width="750">
    <tr>
      <td valign="top" rowspan="2"><table border="0" cellpadding="0" cellspacing="0" width="287">
        <tr>
          <td colspan="2" bgcolor="#A5E4A7" valign="middle" align="center"><b>WWW.ИСХОДНИКИ.РУ</b></td>
          <td bgcolor="#000080" valign="middle" align="center"><b><font face="Tahoma"
          style="font-size: 8pt" size="-1" color="#FFFFFF">cpp.sources.ru</font></b></td>
        </tr>
        <tr>
          <td bgcolor="#000080" valign="middle" align="center"><b><font face="Tahoma"
          style="font-size: 8pt" size="-1" color="#FFFFFF">java.sources.ru</font></b></td>
          <td bgcolor="#C0C0C0" valign="middle" align="center"><font face="Tahoma"
          style="font-size: 8pt" size="-1"><b>web.sources.ru</b></font></td>
          <td bgcolor="#A5E4A7" valign="middle" align="center"><font face="Tahoma"
          style="font-size: 8pt" size="-1"><b>soft.sources.ru</b></font></td>
        </tr>
        <tr>
          <td bgcolor="#C0C0C0" valign="middle" align="center"><font face="Tahoma"
          style="font-size: 8pt" size="-1"><b>jdbc.sources.ru</b></font></td>
          <td bgcolor="#A5E4A7" valign="middle" align="center"><font face="Tahoma"
          style="font-size: 8pt" size="-1"><b>asp.sources.ru</b></font></td>
          <td bgcolor="#000080" valign="middle" align="center"><b><font face="Tahoma"
          style="font-size: 8pt" size="-1" color="#FFFFFF">api.sources.ru</font></b></td>
        </tr>
      </table>
      <table border="0" cellpadding="0" cellspacing="0" width="100%">
        <tr>
          <td><font style="font-size: 8pt" size="2" face="Tahoma">&nbsp; Поиск по
          программированию :<br>
          </font>&nbsp; <input type="text" size="13" name="query"> <input type="submit"
          value="Поиск"><font size="1"><input
          TYPE="Radio" NAME="stype" VALUE="AND" checked>&quot;AND&quot; <input TYPE="Radio"
          NAME="stype" VALUE="OR">&quot;OR&quot;</font>


<!--TopList COUNTER--><a target=_top
href="http://top.list.ru/jump?from=89876"><script language="JavaScript"><!--
d=document;a='';a+=';r='+escape(d.referrer)
js=10//--></script><script language="JavaScript1.1"><!--
a+=';j='+navigator.javaEnabled()
js=11//--></script><script language="JavaScript1.2"><!--
s=screen;a+=';s='+s.width+'*'+s.height
a+=';d='+(s.colorDepth?s.colorDepth:s.pixelDepth)
js=12//--></script><script language="JavaScript1.3"><!--
js=13//--></script><script language="JavaScript"><!--
d.write('<img src="http://top.list.ru/counter'+
'?id=89876;t=57;js='+js+a+';rand='+Math.random()+
'" alt="TopList" '+ 'border=0 height=1 width=1>')
if(js>11)d.write('<'+'!-- ')//--></script><noscript><img
src="http://top.list.ru/counter?js=na;id=89876;t=57"
border=0 height=1 width=1
alt="TopList"></noscript><script language="JavaScript"><!--
if(js>11)d.write('--'+'>')//--></script></a><!--TopList COUNTER-->


<a href="http://counter.rambler.ru/top100/"><img src="http://counter.rambler.ru/top100.cnt?163871" alt="Rambler's Top100" width=1 height=1 border=0></a>

<!-- SpyLOG f:0211 --> 
<script language="javascript"> 
u="u1624.10.spylog.com";d=document;nv=navigator;na=nv.appName;p=1; 
bv=Math.round(parseFloat(nv.appVersion)*100); 
n=(na.substring(0,2)=="Mi")?0:1;rn=Math.random();z="p="+p+"&rn="+rn;y=""; 
y+="<a href='http://"+u+"/cnt?f=3&p="+p+"&rn="+rn+"' target=_blank>"; 
y+="<img src='http://"+u+"/cnt?"+z+ "&r="+escape(d.referrer)+"&pg="+escape(window.location.href)+"' border=0 width=1 height=1 alt='SpyLOG'>"; 
y+="</a>"; d.write(y);if(!n) { d.write("<"+"!--"); }//--></script><noscript> 
<a href="http://u1624.10.spylog.com/cnt?f=3&p=1" target=_blank> 
<img src="http://u1624.10.spylog.com/cnt?p=1" alt='SpyLOG' border='0' width=1 height=1 > 
</a></noscript><script language="javascript1.2"><!-- 
if(!n) { d.write("--"+">"); }//--></script> 
<!-- SpyLOG -->


</td>
        </tr>
      </table>
      </td>
      <td align="center"><font style="font-size: 15pt" color="#4904B1" size="4"
      face="Times New Roman">Информационный сервер</font></td>
    </tr>
    <tr>
      <td>


<!-- LBE -->
<script>
// <!--
rand = Math.round((Math.random() * (10000 - 1)));
document.write("<a href=http://www.lbe.ru/cgi-bin/href/castle?" + rand + " target=_blank><img src=http://www.lbe.ru/cgi-bin/banner/castle?" + rand + " width=468 height=60 border=0 alt=LBE ismap></a><br>");
// -->
</script>
<noscript>
                                                                                                                                                                <br>
</noscript>
<!-- LBE -->



      </td>
    </tr>
    <tr>
      <td colspan="2"><table border="0" cellpadding="0" cellspacing="1" width="100%">
        <tr>
          <td align="center" width="11%" bgcolor="#E0E0C6"><a
          href="../www.sources.html"><font color="#000000" size="2">На главную</font></a></td>
          <td align="center" width="20%" bgcolor="#E0E0C6"><a
          href="../subscribe.html"><font color="#000000" size="2">Подписаться на новости</font></a></td>
          <td align="center" width="11%" bgcolor="#E0E0C6"><a href="../cgi-bin/sources/Ultimate.pl"><font color="#000000" size="2">Форум</font></a></td>
          <td align="center" width="11%" bgcolor="#E0E0C6"><a href="../books.html"><font color="#000000" size="2">Книги</font></a></td>
          <td align="center" width="7%" bgcolor="#E0E0C6"><a href="http://chat.vidcenter.ru:82/"><font color="#000000" size="2">Чат</font></a></td>
          <td align="center" width="13%" bgcolor="#E0E0C6"><a href="http://www.countries.ru/"><font color="#000000" size="2">Страны мира</font></a></td>
          <td align="center" width="29%" bgcolor="#E0E0C6"><b>4</b> пользователей на сервере.
</td>
        </tr>
      </table>
      </td>
    </tr>
  </table>
</form>

<div align="center"><center>

<table width="680" cellspacing="0" cellpadding="0">
  <tr>
    <td><p align="center">&nbsp;</p>
    <h3 align="center"><font color="#a0a099">Возможность перетаскивания элементов в List Control</font></h3>
    <hr>
    <p>Автор: <a href="mailto:jc.dauphin@unesco.org">Jean Claude Dauphin</a>.<!-- Sample image - gif or jpg --> </p>
    <p><img src="DdListCtrl.jpg" width="513" height="348"> </p>
    <h3>Возможности</h3>
    <p>Это расширенный элемент управления позволяет
    перетаскивать элементы между списками при
    помощи OLE. Программист может разрешать/запрещать
    локальное перетаскивание элементов (т.е. в одном
    и том же списке, автоматический скролинг и
    удаление перенесённых элементов из исходного
    списка. </p>
    <h3>Использование элемента</h3>
    <ol>
      <li>Инициализируем библиотеку OLE в функции InitInstance
        Вашего приложения: <pre>BOOL CDdDemoApp::InitInstance()
{
 AfxEnableControlContainer();
#ifdef _AFXDLL
 <span
class="codeComment">// Call this when using MFC in a shared DLL</span>
 Enable3dControls(); 
#else
 <span
class="codeComment">// Call this when linking to MFC statically</span>
 Enable3dControlsStatic(); 
#endif

 <span
class="codeComment">//-------------------------</span>
 <span class="codeComment">// Initialize OLE libraries</span>
 <span
class="codeComment">//-------------------------</span>
 if (!AfxOleInit())
  return FALSE;</pre>
      </li>
      <li>Вставляем #include &quot;DDListCtrl.h&quot; в файл описывающий
        главный диалог приложения и содержащий Списки. </li>
      <li>В функции OnInitDialog диалога, инициализируем и
        создаём собственную инициалицию списков по
        следующему шаблону: <pre>BOOL CDdDemoDlg::OnInitDialog()
{
 CDialog::OnInitDialog();

 //.................................

 <span
class="codeComment">//----------------------------</span><span>&gt;</span>
 <span
class="codeComment">// 1 - Subclass the list controls</span>
 <span class="codeComment">//----------------------------</span>
 m_listVars.SubclassDlgItem(IDC_LIST_VAR, this);
 m_listRows.SubclassDlgItem(IDC_LIST_ROWS, this);
 m_listCols.SubclassDlgItem(IDC_LIST_COLS, this);
 m_listData.SubclassDlgItem(IDC_LIST_DATA, this);
 m_listPages.SubclassDlgItem(IDC_LIST_PAGES, this);
  
 <span
class="codeComment">//--------------------------------------------------------------</span>
 <span
class="codeComment">// 2 - Инициализируем списки</span>
 <span
class="codeComment">//--------------------------------------------------------------</span>
 CString s(TCHAR('M'),29);
 int len = m_listVars.GetStringWidth(s)+15;
 LV_COLUMN lvC;
 lvC.mask = LVCF_FMT | LVCF_WIDTH;
 lvC.fmt  = LVCFMT_LEFT;  <span
class="codeComment">// колонка выравнена влево</span>
 lvC.cx   = len;          <span
class="codeComment">// Ширина колонки в пикселях</span>
 if (m_listVars.InsertColumn(0,&amp;lvC) == -1)
  return FALSE;

 m_listVars.DeleteAllItems();

 m_listVars.SetLocalDD(FALSE);   <span
class="codeComment">// Запрещаем локальный Drag&amp;Drop</span>
 m_listVars.SetScrolling(FALSE); <span
class="codeComment">// и авто скроллирование</span>

 <span class="codeComment">// Create a column for the row variables list view control.</span>
 if (m_listRows.InsertColumn(0,&amp;lvC) == -1)
  return FALSE;

 m_listRows.DeleteAllItems();

 <span
class="codeComment">// Create a column for the column variables list view control.</span>
 if (m_listCols.InsertColumn(0,&amp;lvC) == -1)
  return FALSE;

 m_listCols.DeleteAllItems();

 <span
class="codeComment">// Create a column for the data variables list view control.</span>
 if (m_listData.InsertColumn(0,&amp;lvC) == -1)
  return FALSE;

 m_listData.DeleteAllItems();

 <span
class="codeComment">// Create a column for the page variables view control.</span>
 if (m_listPages.InsertColumn(0,&amp;lvC) == -1)
  return FALSE;
  
 m_listPages.DeleteAllItems();

 <span
class="codeComment">//------------------------------------------</span>
 <span class="codeComment">// 3 - Устанавливаем содержимое списка</span>
 <span
class="codeComment">//------------------------------------------</span>
 CWordArray aVars;
 int size = m_pSelectInfo-&gt;m_asNames.GetSize();
 aVars.SetSize(size);
 <span
class="codeComment">// Initially the list of available variables contains all variables</span>
 for (int i=0; i&lt;size; i++)
  aVars[i] = i;

 <span
class="codeComment">// Заполняем список переменных</span>
 m_pData-&gt;FillListCtrl(m_listVars, aVars);
 m_pData-&gt;FillListCtrl(m_listRows, m_pSelectInfo-&gt;m_aRowsVar); 
 m_pData-&gt;FillListCtrl(m_listCols, m_pSelectInfo-&gt;m_aColsVar);  
 m_pData-&gt;FillListCtrl(m_listData, m_pSelectInfo-&gt;m_aDataVar); 
 m_pData-&gt;FillListCtrl(m_listPages, m_pSelectInfo-&gt;m_aPagesVar); 

 <span
class="codeComment">//-----------------------------------------------</span>
 <span
class="codeComment">// 4 - Инициализируем списки для перетаскивания (Drag&amp;Drop)</span>
 <span
class="codeComment">//-----------------------------------------------</span>
 m_listVars.Initialize();
 m_listRows.Initialize();
 m_listCols.Initialize();
 m_listData.Initialize();
 m_listPages.Initialize();
 
 return TRUE;  
}</pre>
      </li>
    </ol>
    <h3>Downloads</h3>
    <p><a href="DdListCtrl_src.zip">Скачать исходник - 9 Kb</a><br>
    <a href="DdListCtrl_demo.zip">Скачать демонстрашку - 32 Kb</a></p>
    <p>&nbsp;</td>
  </tr>
</table>
</center></div>


<hr>
<div align="center"><center>

<table border="0" cellpadding="0" cellspacing="3" width="468">
  <tr>
    <td width="154"><!-- LBE_LITE --> <script>
// <!--
rand = Math.round((Math.random() * (10000 - 1)));
document.write("<a href=http://lite.lbe.ru/cgi-bin/href/castle?" + rand + " target=_blank><img src=http://lite.lbe.ru/cgi-bin/banner/castle?" + rand + " width=468 height=60 border=0 alt=LBE_LITE ismap></a><br>");
// -->
</script> <noscript> <br>
</noscript><!-- LBE_LITE --></td>
  </tr>
</table>
</center></div>
</body>
</html>
